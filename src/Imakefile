#include "../../libxml2/config.h"
#if HAVE_ZLIB_H
ZLIB=-lz
#endif

#if 0
#define SharedLibFontconfig YES
#endif

#ifndef SharedLibFontconfig
#define SharedLibFontconfig NO
#endif

#ifndef NormalLibFontconfig
#define NormalLibFontconfig (!SharedLibFontConfig | ForceNormalLib)
#endif

#ifndef DebugLibFontconfig
#define DebugLibFontconfig		NO
#endif

#ifndef ProfileLibFontconfig
#define ProfileLibFontconfig		NO
#endif

#define LibHeaders NO

FONTCONFIGSRC=.

FALLBACK_FONTS=$(FONTDIR)/Type1

#if SharedLibFontconfig
#ifndef SharedFontconfigRev
#define SharedFontconfigRev 1.0
#endif
SharedLibReferences(FONTCONFIG,Fontconfig,$(FONTCONFIGSRC),SOXLIBREV,SharedFontconfigRev)
#else
ProjectUnsharedLibReferences(FONTCONFIG,Fontconfig,$(FONTCONFIGSRC),BuildLibDir)
#endif

#define DoNormalLib NormalLibFontconfig
#define DoSharedLib SharedLibFontconfig
#define DoExtraLib SharedLibFontconfig
#define DoDebugLib DebugLibFontconfig
#define DoProfileLib ProfileLibFontconfig
#define HasSharedData YES
#define LibName fontconfig
SOFONTCONFIGREV=1.0
#define SoRev SOFONTCONFIGREV

#include <Threads.tmpl>

#if SharedLibFontconfig
INCLUDES=-I/usr/local/include/freetype2 -I/usr/include/libxml2 -I..
FREETYPE2REQLIB = -L/usr/local/lib -lfreetype
XML2REQLIB=-lxml2
#else
INCLUDES=-I../../freetype2 -I../../libxml2/include -I..
FREETYPE2REQLIB = ../../freetype2/libfreetype.a
XML2REQLIB=../../libxml2/.libs/libxml2.a $(ZLIB) -lm
#endif
DEFINES=-DFC_FALLBACK_FONTS='"$(FALLBACK_FONTS)"'

REQUIREDLIBS=$(LDPRELIBS) $(FREETYPE2REQLIB) $(XML2REQLIB)

SRCS=fcblanks.c fccache.c fccfg.c fccharset.c fcdbg.c fcdefault.c fcdir.c \
     fcfreetype.c fcfs.c fcinit.c fclist.c fcmatch.c fcmatrix.c fcname.c \
     fcpat.c fcstr.c fcxml.c

OBJS=fcblanks.o fccache.o fccfg.o fccharset.o fcdbg.o fcdefault.o fcdir.o \
     fcfreetype.o fcfs.o fcinit.o fclist.o fcmatch.o fcmatrix.o fcname.o \
     fcpat.o fcstr.o fcxml.o

#define LibInstallBuild YES
#undef LinkBuildLibrary
#define LinkBuildLibrary(lib) MakeDir($(BUILDLIBDIR))			@@\
	RemoveFile($(BUILDLIBDIR)/lib)					@@\
	cd $(BUILDLIBDIR) && $(LN) $(BUILDLIBTOP)/$(CURRENT_DIR)/lib .


#include <Library.tmpl>

#if DoSharedLib && SharedDataSeparation
SpecialCObjectRule(sharedlib,NullParameter,$(SHLIBDEF))
#endif

MANSUFFIX = $(LIBMANSUFFIX)
InstallManPage(fontconfig,$(LIBMANDIR))
DependTarget()

